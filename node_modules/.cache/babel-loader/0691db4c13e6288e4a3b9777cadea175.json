{"ast":null,"code":"import appConfig from '../config';\nexport const LOGIN_REQUEST = 'LOGIN_REQUEST';\nexport const LOGIN_SUCCESS = 'LOGIN_SUCCESS';\nexport const LOGIN_FAILURE = 'LOGIN_FAILURE';\nexport const LOGOUT_REQUEST = 'LOGOUT_REQUEST';\nexport const LOGOUT_SUCCESS = 'LOGOUT_SUCCESS';\nexport const LOGOUT_FAILURE = 'LOGOUT_FAILURE';\n\nfunction requestLogin(creds) {\n  return {\n    type: LOGIN_REQUEST,\n    isFetching: true,\n    isAuthenticated: false,\n    creds\n  };\n}\n\nexport function receiveLogin(user) {\n  return {\n    type: LOGIN_SUCCESS,\n    isFetching: false,\n    isAuthenticated: true,\n    id_token: user.id_token\n  };\n}\n\nfunction loginError(message) {\n  return {\n    type: LOGIN_FAILURE,\n    isFetching: false,\n    isAuthenticated: false,\n    message\n  };\n}\n\nfunction requestLogout() {\n  return {\n    type: LOGOUT_REQUEST,\n    isFetching: true,\n    isAuthenticated: true\n  };\n}\n\nexport function receiveLogout() {\n  return {\n    type: LOGOUT_SUCCESS,\n    isFetching: false,\n    isAuthenticated: false\n  };\n} // Logs the user out\n\nexport function logoutUser() {\n  let token_r = localStorage.getItem('id_token');\n  const config = {\n    method: 'POST',\n    headers: {\n      'Authorization': `Bearer ${token_r}`\n    },\n    body: {}\n  };\n  return dispatch => {\n    dispatch(requestLogout());\n    localStorage.removeItem('id_token');\n    document.cookie = 'id_token=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n    return fetch('http://localhost:8000/api/auth/logout', config).then(response => response.json()).then(({\n      response\n    }) => {\n      //debugger\n      if (!response.ok) {// If there was a problem, we want to\n        // dispatch the error condition\n      }\n\n      dispatch(receiveLogout());\n    }).catch(err => console.error('Error: ', err));\n  };\n}\nexport function loginUser(creds) {\n  const config = {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    //credentials: 'include',\n    body: `email=${creds.email}&password=${creds.password}`\n  };\n  return dispatch => {\n    // We dispatch requestLogin to kickoff the call to the API\n    dispatch(requestLogin(creds));\n\n    if (process.env.NODE_ENV === \"development\") {\n      return fetch('http://localhost:8000/api/auth/login', config).then(response => response.json().then(user => ({\n        user,\n        response\n      }))).then(({\n        user,\n        response\n      }) => {\n        //debugger\n        if (!response.ok) {\n          // If there was a problem, we want to\n          // dispatch the error condition\n          dispatch(loginError(user.message));\n          return Promise.reject(user);\n        } // in posts create new action and check http status, if malign logout\n        // If login was successful, set the token in local storage\n\n\n        localStorage.setItem('id_token', user.access_token); // Dispatch the success action\n\n        dispatch(receiveLogin(user));\n        return Promise.resolve(user);\n      }).catch(err => console.error('Error: ', err));\n    } else {\n      localStorage.setItem('id_token', appConfig.id_token);\n      dispatch(receiveLogin({\n        id_token: appConfig.id_token\n      }));\n    }\n  };\n}","map":{"version":3,"sources":["/opt/lampp/htdocs/react-dashboard-master/src/actions/user.js"],"names":["appConfig","LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAILURE","LOGOUT_REQUEST","LOGOUT_SUCCESS","LOGOUT_FAILURE","requestLogin","creds","type","isFetching","isAuthenticated","receiveLogin","user","id_token","loginError","message","requestLogout","receiveLogout","logoutUser","token_r","localStorage","getItem","config","method","headers","body","dispatch","removeItem","document","cookie","fetch","then","response","json","ok","catch","err","console","error","loginUser","email","password","process","env","NODE_ENV","Promise","reject","setItem","access_token","resolve"],"mappings":"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","sourcesContent":["import appConfig from '../config';\n\nexport const LOGIN_REQUEST = 'LOGIN_REQUEST';\nexport const LOGIN_SUCCESS = 'LOGIN_SUCCESS';\nexport const LOGIN_FAILURE = 'LOGIN_FAILURE';\nexport const LOGOUT_REQUEST = 'LOGOUT_REQUEST';\nexport const LOGOUT_SUCCESS = 'LOGOUT_SUCCESS';\nexport const LOGOUT_FAILURE = 'LOGOUT_FAILURE';\n\nfunction requestLogin(creds) {\n  return {\n    type: LOGIN_REQUEST,\n    isFetching: true,\n    isAuthenticated: false,\n    creds,\n  };\n}\n\nexport function receiveLogin(user) {\n  return {\n    type: LOGIN_SUCCESS,\n    isFetching: false,\n    isAuthenticated: true,\n    id_token: user.id_token,\n  };\n}\n\nfunction loginError(message) {\n  return {\n    type: LOGIN_FAILURE,\n    isFetching: false,\n    isAuthenticated: false,\n    message,\n  };\n}\n\nfunction requestLogout() {\n  return {\n    type: LOGOUT_REQUEST,\n    isFetching: true,\n    isAuthenticated: true,\n  };\n}\n\nexport function receiveLogout() {\n  return {\n    type: LOGOUT_SUCCESS,\n    isFetching: false,\n    isAuthenticated: false,\n  };\n}\n\n// Logs the user out\nexport function logoutUser() {\n  let token_r = localStorage.getItem('id_token');\n  const config = {\n    method: 'POST',\n    headers: { 'Authorization': `Bearer ${token_r}` },\n    body: {},\n  };\n  return dispatch => {\n    dispatch(requestLogout());\n    localStorage.removeItem('id_token');\n    document.cookie = 'id_token=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n\n    return fetch('http://localhost:8000/api/auth/logout', config)\n      .then(response => response.json())\n      .then(({ response }) => {\n        //debugger\n        if (!response.ok) {\n          // If there was a problem, we want to\n          // dispatch the error condition\n        }\n        dispatch(receiveLogout());\n      })\n      .catch(err => console.error('Error: ', err));\n  };\n}\n\nexport function loginUser(creds) {\n  const config = {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n    //credentials: 'include',\n    body: `email=${creds.email}&password=${creds.password}`,\n  };\n  \n  return dispatch => {\n    // We dispatch requestLogin to kickoff the call to the API\n    dispatch(requestLogin(creds));\n    if(process.env.NODE_ENV === \"development\") {\n    return fetch('http://localhost:8000/api/auth/login', config)\n      .then(response => response.json().then(user => ({ user, response })))\n      .then(({ user, response }) => {\n        //debugger\n        if (!response.ok) {\n          // If there was a problem, we want to\n          // dispatch the error condition\n          dispatch(loginError(user.message));\n          return Promise.reject(user);\n        }\n        // in posts create new action and check http status, if malign logout\n        // If login was successful, set the token in local storage\n        localStorage.setItem('id_token', user.access_token);\n        // Dispatch the success action\n        dispatch(receiveLogin(user));\n        return Promise.resolve(user);\n      })\n      .catch(err => console.error('Error: ', err));\n    } else {\n      localStorage.setItem('id_token', appConfig.id_token);\n      dispatch(receiveLogin({id_token: appConfig.id_token}))\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}